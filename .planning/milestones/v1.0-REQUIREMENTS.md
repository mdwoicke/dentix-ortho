# Requirements Archive: v1.0 Call Trace Analyzer

**Archived:** 2026-02-02
**Status:** SHIPPED

This is the archived requirements specification for v1.0.

---

## v1 Requirements

### Trace Foundation

- [x] **TRACE-01**: Given a Langfuse session ID or call ID, system retrieves complete trace with all observations, tool calls, and generations
- [x] **TRACE-02**: System extracts structured transcript from trace (caller messages, assistant messages, tool call inputs/outputs)
- [x] **TRACE-03**: System renders observation tree showing hierarchy: LLM generation -> tool call -> API response with latency and status
- [x] **TRACE-04**: System groups multi-trace sessions into single conversation view

### Intent Classification

- [x] **INTENT-01**: System parses conversation transcript to classify caller intent (booking, rescheduling, cancellation, info lookup)
- [x] **INTENT-02**: For booking intents, system extracts structured data: number of children, child names, parent name, phone number, requested dates/times
- [x] **INTENT-03**: System maps intent to expected tool call sequence (e.g., booking -> patient lookup -> slot search -> appointment creation per child)
- [x] **INTENT-04**: System supports all call types: booking, rescheduling, cancellation, info lookup

### Fulfillment Verification

- [x] **VERIFY-01**: System cross-references Langfuse trace tool outputs against live Cloud9 API records (patient profiles, appointments)
- [x] **VERIFY-02**: For booking intents, system verifies: adult patient record exists, child patient record exists per child, appointment record exists per child
- [x] **VERIFY-03**: System verifies record data matches caller-provided info (names, dates, appointment types)
- [x] **VERIFY-04**: System produces pass/fail verdict with specific gap details (which records missing, which data mismatched)
- [x] **VERIFY-05**: For multi-child bookings, system verifies ALL N children have complete records, not just the first

### Expert Agents

- [x] **EXPERT-01**: Node-RED Flow Expert agent
- [x] **EXPERT-02**: Patient Tool Expert agent
- [x] **EXPERT-03**: Scheduling Tool Expert agent
- [x] **EXPERT-04**: System Prompt Expert agent
- [x] **EXPERT-05**: Each expert agent loaded with current V1 artifact as working context

### Diagnostics

- [x] **DIAG-01**: Diagnostic orchestrator routes to relevant expert agent(s) based on failure location
- [x] **DIAG-02**: Expert agents produce markdown report with root cause, affected artifact, confidence level
- [x] **DIAG-03**: Diagnostic report includes PR-ready code diff
- [x] **DIAG-04**: System correlates failures with Node-RED flow deploy versions
- [x] **DIAG-05**: Expert agents invocable standalone for manual troubleshooting

### Replay

- [x] **REPLAY-01**: System generates test harness mocking Cloud9 API responses from trace
- [x] **REPLAY-02**: System re-sends caller messages through Flowise to reproduce issues
- [x] **REPLAY-03**: System tests Cloud9 API directly to isolate bottleneck

### Monitoring

- [x] **MON-01**: Automatic intent-vs-fulfillment check on every completed call
- [x] **MON-02**: Auto-trigger full trace analysis with diagnostics on failures
- [x] **MON-03**: Filter traces by date, pass/fail status, intent type, and session ID search

### UI

- [x] **UI-01**: Dedicated trace analysis page in App UI
- [x] **UI-02**: Page displays trace tree, transcript, intent classification, and fulfillment verdict
- [x] **UI-03**: Page shows diagnostic report when available
- [x] **UI-04**: Page allows manual trigger of deep analysis on any trace

## Traceability

| Requirement | Phase | Status |
|-------------|-------|--------|
| TRACE-01 | Phase 1 | Complete |
| TRACE-02 | Phase 1 | Complete |
| TRACE-03 | Phase 1 | Complete |
| TRACE-04 | Phase 1 | Complete |
| INTENT-01 | Phase 1 | Complete |
| INTENT-02 | Phase 1 | Complete |
| INTENT-03 | Phase 1 | Complete |
| INTENT-04 | Phase 1 | Complete |
| VERIFY-01 | Phase 2 | Complete |
| VERIFY-02 | Phase 2 | Complete |
| VERIFY-03 | Phase 2 | Complete |
| VERIFY-04 | Phase 2 | Complete |
| VERIFY-05 | Phase 2 | Complete |
| UI-01 | Phase 3 | Complete |
| UI-02 | Phase 3 | Complete |
| UI-03 | Phase 3 | Complete |
| UI-04 | Phase 3 | Complete |
| EXPERT-01 | Phase 4 | Complete |
| EXPERT-02 | Phase 4 | Complete |
| EXPERT-03 | Phase 4 | Complete |
| EXPERT-04 | Phase 4 | Complete |
| EXPERT-05 | Phase 4 | Complete |
| DIAG-01 | Phase 4 | Complete |
| DIAG-02 | Phase 4 | Complete |
| DIAG-03 | Phase 4 | Complete |
| DIAG-04 | Phase 4 | Complete |
| DIAG-05 | Phase 4 | Complete |
| REPLAY-01 | Phase 5 | Complete |
| REPLAY-02 | Phase 5 | Complete |
| REPLAY-03 | Phase 5 | Complete |
| MON-01 | Phase 6 | Complete |
| MON-02 | Phase 6 | Complete |
| MON-03 | Phase 6 | Complete |

## Milestone Summary

**Shipped:** 33 of 33 v1 requirements
**Adjusted:** None
**Dropped:** None

---
*Archived: 2026-02-02 as part of v1.0 milestone completion*
